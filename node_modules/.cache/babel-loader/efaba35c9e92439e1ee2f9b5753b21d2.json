{"ast":null,"code":"import _slicedToArray from\"/Users/arcsec/Documents/Virufy/virufy-demo.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable func-names */import React from'react';var usePWAHelpers=function usePWAHelpers(buttonId){var deferredInstallPromptRef=React.useRef(null);var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),isInstalled=_React$useState2[0],setIsInstalled=_React$useState2[1];React.useEffect(function(){// BeforeInstallPrompt\nvar beforeInstallPromptFn=function beforeInstallPromptFn(e){e.preventDefault();deferredInstallPromptRef.current=e;var installButton=document.getElementById(buttonId);if(installButton){installButton.addEventListener('click',function(){e.prompt();});}};window.addEventListener('beforeinstallprompt',beforeInstallPromptFn);// App Installed\nvar appInstalledFn=function appInstalledFn(){setIsInstalled(true);};window.addEventListener('appinstalled',appInstalledFn);return function(){window.removeEventListener('beforeinstallprompt',beforeInstallPromptFn);window.removeEventListener('appinstalled',appInstalledFn);};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);React.useEffect(function(){var isStandalone=window.matchMedia('(display-mode: standalone)').matches||window.navigator.standalone;if(isStandalone){setIsInstalled(true);}else if(window.navigator.getInstalledRelatedApps){window.navigator.getInstalledRelatedApps().then(function(r){if(r){setIsInstalled(r.length>0);}});}},[]);var handlePrompt=React.useCallback(function(){if(deferredInstallPromptRef.current){return deferredInstallPromptRef.current.userChoice;}return undefined;// eslint-disable-next-line react-hooks/exhaustive-deps\n},[deferredInstallPromptRef.current]);return{isInstalled:isInstalled,setIsInstalled:setIsInstalled,handlePrompt:handlePrompt};};export default usePWAHelpers;","map":{"version":3,"sources":["/Users/arcsec/Documents/Virufy/virufy-demo.github.io/src/hooks/usePWAHelpers.ts"],"names":["React","usePWAHelpers","buttonId","deferredInstallPromptRef","useRef","useState","isInstalled","setIsInstalled","useEffect","beforeInstallPromptFn","e","preventDefault","current","installButton","document","getElementById","addEventListener","prompt","window","appInstalledFn","removeEventListener","isStandalone","matchMedia","matches","navigator","standalone","getInstalledRelatedApps","then","r","length","handlePrompt","useCallback","userChoice","undefined"],"mappings":"2KAAA,+BACA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAkBA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,QAAD,CAAsB,CAC1C,GAAMC,CAAAA,wBAAwB,CAAGH,KAAK,CAACI,MAAN,CAA8C,IAA9C,CAAjC,CAD0C,oBAEJJ,KAAK,CAACK,QAAN,CAA+B,IAA/B,CAFI,oDAEnCC,WAFmC,qBAEtBC,cAFsB,qBAI1CP,KAAK,CAACQ,SAAN,CAAgB,UAAM,CACpB;AACA,GAAMC,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,CAAUC,CAAV,CAAuC,CACnEA,CAAC,CAACC,cAAF,GACAR,wBAAwB,CAACS,OAAzB,CAAmCF,CAAnC,CAEA,GAAMG,CAAAA,aAAa,CAAGC,QAAQ,CAACC,cAAT,CAAwBb,QAAxB,CAAtB,CACA,GAAIW,aAAJ,CAAmB,CACjBA,aAAa,CAACG,gBAAd,CAA+B,OAA/B,CAAwC,UAAM,CAC5CN,CAAC,CAACO,MAAF,GACD,CAFD,EAGD,CACF,CAVD,CAWAC,MAAM,CAACF,gBAAP,CAAwB,qBAAxB,CAA+CP,qBAA/C,EAEA;AACA,GAAMU,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAC3BZ,cAAc,CAAC,IAAD,CAAd,CACD,CAFD,CAGAW,MAAM,CAACF,gBAAP,CAAwB,cAAxB,CAAwCG,cAAxC,EAEA,MAAO,WAAM,CACXD,MAAM,CAACE,mBAAP,CAA2B,qBAA3B,CAAkDX,qBAAlD,EACAS,MAAM,CAACE,mBAAP,CAA2B,cAA3B,CAA2CD,cAA3C,EACD,CAHD,CAIA;AACD,CA1BD,CA0BG,EA1BH,EA4BAnB,KAAK,CAACQ,SAAN,CAAgB,UAAM,CACpB,GAAMa,CAAAA,YAAY,CAAGH,MAAM,CAACI,UAAP,CAAkB,4BAAlB,EAAgDC,OAAhD,EAA2DL,MAAM,CAACM,SAAP,CAAiBC,UAAjG,CACA,GAAIJ,YAAJ,CAAkB,CAChBd,cAAc,CAAC,IAAD,CAAd,CACD,CAFD,IAEO,IAAIW,MAAM,CAACM,SAAP,CAAiBE,uBAArB,CAA8C,CACnDR,MAAM,CAACM,SAAP,CAAiBE,uBAAjB,GAA2CC,IAA3C,CAAgD,SAAAC,CAAC,CAAI,CACnD,GAAIA,CAAJ,CAAO,CACLrB,cAAc,CAACqB,CAAC,CAACC,MAAF,CAAW,CAAZ,CAAd,CACD,CACF,CAJD,EAKD,CACF,CAXD,CAWG,EAXH,EAaA,GAAMC,CAAAA,YAAY,CAAG9B,KAAK,CAAC+B,WAAN,CAAkB,UAAM,CAC3C,GAAI5B,wBAAwB,CAACS,OAA7B,CAAsC,CACpC,MAAOT,CAAAA,wBAAwB,CAACS,OAAzB,CAAiCoB,UAAxC,CACD,CACD,MAAOC,CAAAA,SAAP,CACF;AACC,CANoB,CAMlB,CAAC9B,wBAAwB,CAACS,OAA1B,CANkB,CAArB,CAQA,MAAO,CACLN,WAAW,CAAXA,WADK,CAELC,cAAc,CAAdA,cAFK,CAGLuB,YAAY,CAAZA,YAHK,CAAP,CAKD,CA1DD,CA4DA,cAAe7B,CAAAA,aAAf","sourcesContent":["/* eslint-disable func-names */\nimport React from 'react';\n\ninterface BeforeInstallPromptEvent extends Event {\n  prompt: () => void;\n  userChoice: Promise<string>;\n}\n\ndeclare global {\n\n  interface App {\n    id: string;\n  }\n  interface Navigator {\n    standalone?: boolean; // Available on Apple's iOS Safari only.\n    getInstalledRelatedApps?: () => Promise<App[] | null>; // Available on chrome only\n  }\n}\n\nconst usePWAHelpers = (buttonId: string) => {\n  const deferredInstallPromptRef = React.useRef<BeforeInstallPromptEvent | null>(null);\n  const [isInstalled, setIsInstalled] = React.useState<boolean | null>(null);\n\n  React.useEffect(() => {\n    // BeforeInstallPrompt\n    const beforeInstallPromptFn = function (e: BeforeInstallPromptEvent) {\n      e.preventDefault();\n      deferredInstallPromptRef.current = e;\n\n      const installButton = document.getElementById(buttonId);\n      if (installButton) {\n        installButton.addEventListener('click', () => {\n          e.prompt();\n        });\n      }\n    };\n    window.addEventListener('beforeinstallprompt', beforeInstallPromptFn as EventListener);\n\n    // App Installed\n    const appInstalledFn = () => {\n      setIsInstalled(true);\n    };\n    window.addEventListener('appinstalled', appInstalledFn as EventListener);\n\n    return () => {\n      window.removeEventListener('beforeinstallprompt', beforeInstallPromptFn as EventListener);\n      window.removeEventListener('appinstalled', appInstalledFn as EventListener);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  React.useEffect(() => {\n    const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;\n    if (isStandalone) {\n      setIsInstalled(true);\n    } else if (window.navigator.getInstalledRelatedApps) {\n      window.navigator.getInstalledRelatedApps().then(r => {\n        if (r) {\n          setIsInstalled(r.length > 0);\n        }\n      });\n    }\n  }, []);\n\n  const handlePrompt = React.useCallback(() => {\n    if (deferredInstallPromptRef.current) {\n      return deferredInstallPromptRef.current.userChoice;\n    }\n    return undefined;\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [deferredInstallPromptRef.current]);\n\n  return {\n    isInstalled,\n    setIsInstalled,\n    handlePrompt,\n  };\n};\n\nexport default usePWAHelpers;\n"]},"metadata":{},"sourceType":"module"}