{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/amil/virufy-demo.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/amil/virufy-demo.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/amil/virufy-demo.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useCallback,useState}from'react';import{useHistory}from'react-router-dom';import{useTranslation,Trans}from'react-i18next';import usePortal from'react-useportal';// Form\nimport{useForm,Controller}from'react-hook-form';import{useStateMachine}from'little-state-machine';import{yupResolver}from'@hookform/resolvers/yup';import*as Yup from'yup';// Header Control\nimport useHeaderContext from'hooks/useHeaderContext';// Components\nimport WizardButtons from'components/WizardButtons';import Dropdown from'components/Dropdown';// Update Action\nimport{updateAction}from'utils/wizard';// Theme\n// Assets\nimport HeaderSplash from'assets/images/headerSplash.png';// Utils\nimport{scrollToTop}from'helper/scrollHelper';// Data\nimport{languageData}from'data/lang';// Styles\nimport Link from'components/Link';import{WelcomeContent,WelcomeStyledFormAlternative,HeaderImageContainer,HeaderImage,LogoWhiteBG,BoldBlackText,WelcomeNote,BoldBlackTextPrivacy}from'../style';var schema=Yup.object().shape({language:Yup.string().required()}).defined();var Step2=function Step2(p){var _usePortal=usePortal({bindTo:document&&document.getElementById('wizard-buttons')}),Portal=_usePortal.Portal;var _useStateMachine=useStateMachine({updateAction:updateAction(p.storeKey)}),state=_useStateMachine.state,actions=_useStateMachine.actions;var _useHeaderContext=useHeaderContext(),setDoGoBack=_useHeaderContext.setDoGoBack,setType=_useHeaderContext.setType,setTitle=_useHeaderContext.setTitle;// Hook Form\nvar _useForm=useForm({defaultValues:state===null||state===void 0?void 0:state[p.storeKey],resolver:yupResolver(schema),mode:'onChange'}),control=_useForm.control,formState=_useForm.formState,handleSubmit=_useForm.handleSubmit,watch=_useForm.watch,reset=_useForm.reset;var isValid=formState.isValid;var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;React.useEffect(function(){// NOTE: repopulate default values\nif(state&&state[p.storeKey]){reset(state[p.storeKey]);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);// eslint-disable-next-line @typescript-eslint/no-unused-vars\nvar _useState=useState(true),_useState2=_slicedToArray(_useState,2),activeStep=_useState2[0],setActiveStep=_useState2[1];var history=useHistory();var doBack=useCallback(function(){if(p.previousStep){setActiveStep(false);history.push(p.previousStep);}else{history.goBack();}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(values){actions.updateAction(values);if(p.nextStep){setActiveStep(false);history.push(p.nextStep);}}case 1:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();useEffect(function(){scrollToTop();setDoGoBack(function(){return doBack;});setType('nothing');setTitle('');},[doBack,setDoGoBack,setTitle,setType]);var lang=watch('language');React.useEffect(function(){i18n.changeLanguage(lang);},[i18n,lang]);return/*#__PURE__*/_jsxs(WelcomeStyledFormAlternative,{children:[/*#__PURE__*/_jsxs(HeaderImageContainer,{children:[/*#__PURE__*/_jsx(HeaderImage,{src:HeaderSplash}),/*#__PURE__*/_jsx(LogoWhiteBG,{})]}),/*#__PURE__*/_jsx(BoldBlackText,{children:t('main:selectYourLanguage','Language')}),/*#__PURE__*/_jsx(Controller,{control:control,name:\"language\",defaultValue:i18n.language.split('-')[0]||languageData[0].code,render:function render(_ref2){var _onChange=_ref2.onChange,value=_ref2.value;return/*#__PURE__*/_jsx(Dropdown,{onChange:function onChange(e){return _onChange(e.currentTarget.value);},value:value,children:languageData.map(function(_ref3){var code=_ref3.code,label=_ref3.label;return/*#__PURE__*/_jsx(\"option\",{id:code,value:code,children:label},code);})});}}),/*#__PURE__*/_jsxs(WelcomeContent,{children:[/*#__PURE__*/_jsx(WelcomeNote,{children:/*#__PURE__*/_jsxs(Trans,{i18nKey:\"main:note\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Please note:\"}),\" This form is for data collection only. It will not predict your COVID-19 status or diagnose any disease, disorder, or other health condition. Virufy is conducting research and will use the information you provide for that research only. Virufy will not take place of a doctor and would like to remind you it is your responsibility to seek medical advice from your doctor.\"]})}),/*#__PURE__*/_jsx(BoldBlackTextPrivacy,{children:/*#__PURE__*/_jsx(Link,{to:\"https://virufy.org/privacy_policy/\",target:\"_blank\",children:/*#__PURE__*/_jsx(Trans,{i18nKey:\"main:privacyPolicy\",children:\"By proceeding you accept the terms of our Privacy Policy\"})})}),activeStep&&/*#__PURE__*/_jsx(Portal,{children:/*#__PURE__*/_jsx(WizardButtons,{invert:true,leftLabel:t('helpVirufy:nextButton'),leftHandler:handleSubmit(onSubmit),leftDisabled:!isValid})})]})]});};export default/*#__PURE__*/React.memo(Step2);","map":{"version":3,"sources":["/home/amil/virufy-demo.github.io/src/containers/Welcome/Step2/Step2.tsx"],"names":["React","useEffect","useCallback","useState","useHistory","useTranslation","Trans","usePortal","useForm","Controller","useStateMachine","yupResolver","Yup","useHeaderContext","WizardButtons","Dropdown","updateAction","HeaderSplash","scrollToTop","languageData","Link","WelcomeContent","WelcomeStyledFormAlternative","HeaderImageContainer","HeaderImage","LogoWhiteBG","BoldBlackText","WelcomeNote","BoldBlackTextPrivacy","schema","object","shape","language","string","required","defined","Step2","p","bindTo","document","getElementById","Portal","storeKey","state","actions","setDoGoBack","setType","setTitle","defaultValues","resolver","mode","control","formState","handleSubmit","watch","reset","isValid","t","i18n","activeStep","setActiveStep","history","doBack","previousStep","push","goBack","onSubmit","values","nextStep","lang","changeLanguage","split","code","onChange","value","e","currentTarget","map","label","memo"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useTranslation, Trans } from 'react-i18next';\nimport usePortal from 'react-useportal';\n\n// Form\nimport { useForm, Controller } from 'react-hook-form';\nimport { useStateMachine } from 'little-state-machine';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as Yup from 'yup';\n\n// Header Control\nimport useHeaderContext from 'hooks/useHeaderContext';\n\n// Components\nimport WizardButtons from 'components/WizardButtons';\nimport Dropdown from 'components/Dropdown';\n\n// Update Action\nimport { updateAction } from 'utils/wizard';\n\n// Theme\n\n// Assets\nimport HeaderSplash from 'assets/images/headerSplash.png';\n\n// Utils\nimport { scrollToTop } from 'helper/scrollHelper';\n\n// Data\nimport { languageData } from 'data/lang';\n\n// Styles\nimport Link from 'components/Link';\nimport {\n  WelcomeContent,\n  WelcomeStyledFormAlternative,\n  HeaderImageContainer,\n  HeaderImage,\n  LogoWhiteBG,\n  BoldBlackText,\n  WelcomeNote,\n  BoldBlackTextPrivacy,\n} from '../style';\n\nconst schema = Yup.object().shape({\n  language: Yup.string().required(),\n}).defined();\n\ntype Step2Type = Yup.InferType<typeof schema>;\n\nconst Step2 = (p: Wizard.StepProps) => {\n  const { Portal } = usePortal({\n    bindTo: document && document.getElementById('wizard-buttons') as HTMLDivElement,\n  });\n  const {\n    state,\n    actions,\n  } = useStateMachine({ updateAction: updateAction(p.storeKey) });\n  const {\n    setDoGoBack,\n    setType,\n    setTitle,\n  } = useHeaderContext();\n\n  // Hook Form\n  const {\n    control,\n    formState,\n    handleSubmit,\n    watch,\n    reset,\n    // setValue,\n  } = useForm({\n    defaultValues: state?.[p.storeKey],\n    resolver: yupResolver(schema),\n    mode: 'onChange',\n  });\n  const { isValid } = formState;\n  const { t, i18n } = useTranslation();\n\n  React.useEffect(() => {\n    // NOTE: repopulate default values\n    if (state && state[p.storeKey]) {\n      reset(state[p.storeKey]);\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [activeStep, setActiveStep] = useState(true);\n\n  const history = useHistory();\n\n  const doBack = useCallback(() => {\n    if (p.previousStep) {\n      setActiveStep(false);\n      history.push(p.previousStep);\n    } else {\n      history.goBack();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const onSubmit = async (values: Step2Type) => {\n    if (values) {\n      actions.updateAction(values);\n      if (p.nextStep) {\n        setActiveStep(false);\n        history.push(p.nextStep);\n      }\n    }\n  };\n\n  useEffect(() => {\n    scrollToTop();\n    setDoGoBack(() => doBack);\n    setType('nothing');\n    setTitle('');\n  }, [doBack, setDoGoBack, setTitle, setType]);\n\n  const lang = watch('language');\n\n  React.useEffect(() => {\n    i18n.changeLanguage(lang);\n  }, [i18n, lang]);\n\n  return (\n    <WelcomeStyledFormAlternative>\n      <HeaderImageContainer>\n        <HeaderImage\n          src={HeaderSplash}\n        />\n        <LogoWhiteBG />\n      </HeaderImageContainer>\n\n      {/* Language */}\n      <BoldBlackText>\n        {t('main:selectYourLanguage', 'Language')}\n      </BoldBlackText>\n\n      <Controller\n        control={control}\n        name=\"language\"\n        defaultValue={i18n.language.split('-')[0] || languageData[0].code}\n        render={({ onChange, value }) => (\n          <Dropdown\n            onChange={e => onChange(e.currentTarget.value)}\n            value={value}\n          >\n            {\n                languageData.map(({ code, label }) => (\n                  <option\n                    key={code}\n                    id={code}\n                    value={code}\n                  >\n                    {label}\n                  </option>\n                ))\n              }\n          </Dropdown>\n        )}\n      />\n\n      <WelcomeContent>\n        <WelcomeNote>\n          <Trans i18nKey=\"main:note\">\n            <strong>Please note:</strong> This form is for data collection only. It will not predict your COVID-19\n            status or diagnose any disease, disorder, or other health condition. Virufy is conducting research and\n            will use the information you provide for that research only. Virufy will not take place of a doctor and\n            would like to remind you it is your responsibility to seek medical advice from your doctor.\n          </Trans>\n        </WelcomeNote>\n\n        <BoldBlackTextPrivacy>\n          <Link to=\"https://virufy.org/privacy_policy/\" target=\"_blank\">\n            <Trans i18nKey=\"main:privacyPolicy\">\n              By proceeding you accept the terms of our Privacy Policy\n            </Trans>\n          </Link>\n        </BoldBlackTextPrivacy>\n\n        {activeStep && (\n          <Portal>\n            <WizardButtons\n              invert\n              leftLabel={t('helpVirufy:nextButton')}\n              leftHandler={handleSubmit(onSubmit)}\n              leftDisabled={!isValid}\n            />\n          </Portal>\n        )}\n      </WelcomeContent>\n    </WelcomeStyledFormAlternative>\n  );\n};\n\nexport default React.memo(Step2);\n"]},"metadata":{},"sourceType":"module"}